x=[-0.104773;-0.0931360;-0.0815;-0.116409;-0.0815;-0.116409;-0.104773;-0.0931360;-0.0931360;-0.0931360;-0.0931360;-0.0931360;-0.0931360;-0.0931360;-0.0582270;-0.0931360;-0.104773;-0.0931360;-0.0815;-0.0931360;-0.0931360;-0.104773;-0.139682;-0.151318;-0.162955;-0.197864;-0.232773;-0.267682;-0.337500;-0.407318;-0.418955;-0.453864;-0.488773;-0.500409;-0.535318;-0.546955;-0.535318;-0.535318;-0.523682;-0.523682;-0.488773;-0.477136;-0.442227;-0.442227;-0.407318;-0.372409;-0.360773;-0.325864;-0.337500;-0.337500;-0.267682;-0.256045;-0.256045;-0.290955;-0.256045;-0.244409;-0.209500;-0.209500;-0.221136;-0.221136;-0.221136;-0.186227;-0.221136;-0.186227;-0.221136;-0.221136;-0.186227;-0.256045;-0.267682;-0.232773;-0.244409;-0.244409;-0.256045;-0.256045;-0.244409;-0.232773;-0.232773;-0.267682;-0.256045;-0.267682;-0.256045;-0.267682;-0.256045;-0.244409;-0.256045;-0.221136;-0.232773;-0.244409;-0.279318;-0.314227;-0.279318;-0.244409;-0.174591;-0.209500;-0.279318;-0.209500;-0.174591;-0.244409;-0.104773;-0.0931360;-0.128045;-0.162955;-0.232773;-0.302591;-0.232773;-0.197864;-0.232773;-0.267682;-0.302591;-0.314227;-0.325864;-0.325864;-0.290955;-0.302591;-0.337500;-0.325864;-0.290955;-0.325864;-0.325864;-0.465500;-0.395682;-0.151318;0.279273;0.523636;0.279273;-0.523682;-1.338227;-1.268409;-1.23350;-0.989136;-0.744773;-0.605136;-0.465500;-0.221136;-0.151318;-0.139682;-0.209500;-0.174591;-0.139682;-0.151318;-0.186227;-0.221136;-0.0815;-0.0931360;-0.128045;-0.0931360;-0.162955;-0.174591;-0.209500;-0.0698640;-4.50000e-05;-0.0349550;-0.104773;-0.244409;-0.104773;-0.174591;-0.418955;-0.384045;-0.349136;-0.209500;-0.0698640;0.0581820;0.128;0.0581820;-0.0698640;-0.104773;-0.174591;-0.139682;-0.174591;-0.244409;-0.314227;-0.325864;-0.360773;-0.430591;-0.465500;-0.430591;-0.500409;-0.570227;-0.581864;-0.616773;-0.651682;-0.581864;-0.512045;-0.500409;-0.512045;-0.477136;-0.488773;-0.349136;-0.314227;-0.349136;-0.279318;-0.314227;-0.384045;-0.349136;-0.279318;-0.209500;-0.174591;-0.244409;-0.314227;-0.244409;-0.279318;-0.244409;-0.244409;-0.209500;-0.221136;-0.256045;-0.186227;-0.256045;-0.221136;-0.232773;-0.372409;-0.302591;-0.302591;-0.267682;-0.128045;-0.0582270;-0.128045;-0.267682;-0.197864;-0.128045;-0.139682;-0.128045;-0.162955;-0.162955;-0.0931360;-0.128045;-0.197864;-0.337500;-0.197864;-0.162955;-0.128045;-0.116409;-0.0815;-0.116409;-0.116409;-0.128045;-0.162955;-0.0931360;-0.0233180;-0.0582270;0;0.0349090;0;-0.0582270;-0.0931360;-0.128045;-0.116409;-0.128045;-0.116409;-0.116409;-0.151318;-0.116409;-0.151318;-0.139682;-0.151318;-0.186227;-0.116409;-0.116409;-0.116409;-0.151318;-0.221136;-0.290955;-0.151318;0.279273;0.721455;0.477091;-0.325864;-1.140409;-1.175318;-1.10550;-0.861136;-0.616773;-0.372409;-0.232773;-0.0931360;-0.0233180;0;-0.0233180;0;0;0.0349090;0.0698180;0;0.0116360;0.0814550;0.0116360;0.0814550;0.116364;0.104727;0.0349090;0.0349090;0.0698180;0.0698180;0.0814550;0.0698180;0.0349090;0.174545;0.174545;0.104727;0.174545;0.139636;0.128;0.116364;0.0814550;0.0698180;0.139636;0.151273;0.116364;0.0465450;0.0465450;0.0116360;-0.0465910;-0.0815;-0.116409;-0.104773;-0.139682;-0.209500;-0.244409;-0.279318;-0.279318;-0.314227;-0.325864;-0.290955;-0.302591;-0.267682;-0.267682;-0.232773;-0.162955;-0.162955;-0.128045;-0.162955;-0.151318;-0.0815;-0.0465910;-0.0349550;-0.0233180;-0.0116820;0.0465450;0.0116360;-0.0116820;0.0116360;-0.0116820;0.0116360;0.0232730;0.0232730;0.0349090;0;0.0116360;0.0116360;0;0.0349090;0.0349090;0;0.0349090;-0.0233180;0.0349090;0.0698180;0.0581820;0.0232730;0.0232730;0.0581820;0.0930910;0.0581820;0.0465450;0.0116360;0.0116360;0.0116360;0.0232730;-4.50000e-05;-0.0116820;0.0116360;0.0232730;0.0581820;0.0232730;0.0232730;0.0581820;0.0698180;0.0349090;0.0698180;0.104727;0.139636;0.174545;0.174545;0.139636;0.174545;0.104727;0.0698180;0;0.0698180;0.0349090;0.0349090;0;0.0349090;-0.0233180;0.0349090;0;-4.50000e-05;-0.0116820;0.0116360;-0.116409;-0.151318;-0.0815;-0.0116820;-0.0116820;0.0465450;0.290909;0.733091;1.175273;0.733091;-0.0698640;-0.884409;-1.024045;-0.884409;-0.640045;-0.395682;-0.151318;0.0814550;0.0814550;0.0116360;-0.0116820;0.116364;0.256;0.186182;0.0465450;0.186182;0.221091;0.360727;0.325818;0.360727;0.290909;0.279273;0.267636;0.302545;0.267636;0.197818;0.162909;0.197818;0.267636;0.302545;0.162909;0.174545;0.209455;0.244364;0.232727;0.302545;0.302545;0.232727;0.302545;0.267636;0.267636;0.232727;0.232727;0.197818;0.128;-4.50000e-05;-0.0698640;0.0581820;-0.0698640;-0.314227;-0.302591;-0.267682;-0.232773;-0.0931360;-0.0931360;-0.128045;-0.267682;-0.302591;-0.232773;0;0.0698180;0.104727;0.0349090;0.0465450;0.116364;0.256;0.186182;0.186182;0.0465450;-0.0116820;0.0116360;0.151273;0.221091;0.290909;0.302545;0.290909;0.360727;0.290909;0.0465450;0.0116360;0.256;0.290909;0.302545;0.232727;0.232727;0.372364;0.384;0.139636;0;0.139636;0.384;0.418909;0.279273;0.139636;0.139636;0.279273;0.279273;0.244364;0.314182;0.453818;0.523636;0.453818;0.384;0.244364;0.174545;0.186182;0.256;0.325818;0.465455;0.535273;0.395636;0.465455;0.605091;0.674909;0.430545;0.290909;0.325818;0.360727;0.221091;0.209455;0.349091;0.488727;0.418909;0.279273;0.209455;0.197818;0.209455;0.244364;0.314182;0.384;0.384;0.349091;0.360727;0.802909;1.245091;1.105455;0.290909;-0.512045;-0.581864;-0.512045;-0.442227;-0.302591;-0.0582270;0.174545;0.418909;0.453818;0.418909;0.488727;0.477091;0.512;0.500364;0.640;0.605091;0.640;0.500364;0.465455;0.500364;0.640;0.628364;0.628364;0.558545;0.628364;0.698182;0.558545;0.628364;0.616727;0.686545;0.686545;0.546909;0.407273;0.651636;0.721455;0.733091;0.663273;0.523636;0.453818;0.593455;0.663273;0.802909;0.558545;0.418909;0.384;0.523636;0.558545;0.418909;0.174545;0.174545;0.162909;0.197818;0.232727;0.221091;0.209455;0.279273;0.314182;0.244364;0.104727;0.139636;0.279273;0.418909;0.453818;0.418909;0.384;0.418909;0.418909;0.488727;0.523636;0.593455;0.558545;0.570182;0.535273;0.500364;0.465455;0.500364;0.570182;0.500364;0.570182;0.640;0.570182;0.430545;0.500364;0.512;0.546909;0.512;0.581818;0.546909;0.546909;0.512;0.546909;0.512;0.500364;0.465455;0.535273;0.605091;0.570182;0.535273;0.570182;0.535273;0.570182;0.430545;0.465455;0.430545;0.570182;0.640;0.674909;0.640;0.628364;0.640;0.651636;0.581818;0.512;0.523636;0.523636;0.453818;0.442182;0.477091;0.465455;0.477091;0.407273;0.372364;0.407273;0.477091;0.512;0.442182;0.477091;0.477091;0.407273;0.337455;0.477091;0.919273;1.163636;1.233455;0.418909;-0.384045;-0.523682;-0.512045;-0.372409;-0.128045;-0.0582270;0.174545;0.314182;0.453818;0.523636;0.558545;0.523636;0.558545;0.546909;0.558545;0.593455;0.628364;0.593455;0.581818;0.581818;0.570182;0.605091;0.605091;0.616727;0.605091;0.593455;0.593455;0.628364;0.628364;0.616727;0.581818;0.616727;0.651636;0.616727;0.581818;0.651636;0.640;0.640;0.605091;0.570182;0.570182;0.558545;0.523636;0.488727;0.453818;0.418909;0.384;0.314182;0.279273;0.244364;0.209455;0.209455;0.174545;0.162909;0.151273;0.186182;0.197818;0.186182;0.174545;0.209455;0.244364;0.244364;0.279273;0.314182;0.314182;0.349091;0.337455;0.372364;0.384;0.384;0.384;0.384;0.453818;0.488727;0.453818;0.418909;0.430545;0.430545;0.465455;0.430545;0.430545;0.418909;0.407273;0.407273;0.407273;0.407273;0.372364;0.372364;0.384;0.372364;0.372364;0.360727;0.372364;0.337455;0.349091;0.349091;0.349091;0.337455;0.337455;0.325818;0.360727;0.325818;0.360727;0.430545;0.465455;0.500364;0.500364;0.488727;0.349091;0.337455;0.302545;0.314182;0.279273;0.244364;0.244364;0.209455;0.209455;0.221091;0.186182;0.186182;0.174545;0.186182;0.197818;0.197818;0.162909;0.174545;0.139636;0.209455;0.453818;0.896;1.140364;0.698182;-0.104773;-0.919318;-0.884409;-0.744773;-0.500409;-0.360773;-0.116409;0.0116360;0.151273;0.221091;0.232727;0.232727;0.232727;0.244364;0.244364;0.256;0.267636;0.302545;0.267636;0.279273;0.267636;0.267636;0.279273;0.290909;0.290909;0.302545;0.267636;0.302545;0.337455;0.302545;0.302545;0.290909;0.279273;0.314182;0.302545;0.302545;0.302545;0.302545;0.290909;0.256;0.256;0.221091;0.232727;0.197818;0.162909;0.128;0.0930910;0.0581820;0.0232730;-0.0349550;-0.0698640;-0.0582270;-0.0465910;-0.0815;-0.0931360;-0.104773;-0.0931360;-0.0815;-0.0465910;-0.0349550;-4.50000e-05;0;0.0349090;0.0465450;0.0581820;0.0698180;0.0814550;0.116364;0.128;0.128;0.162909;0.162909;0.174545;0.174545;0.174545;0.174545;0.174545;0.174545;0.174545;0.174545;0.186182;0.197818;0.162909;0.197818;0.162909;0.197818;0.162909;0.174545;0.174545;0.174545;0.209455;0.174545;0.174545;0.209455;0.209455;0.244364;0.279273;0.279273;0.314182;0.349091;0.384;0.314182;0.244364;0.209455;0.174545;0.174545;0.139636;0.139636;0.128;0.0930910;0.0930910;0.0814550;0.0814550;0.0814550;0.0698180;0.0814550;0.0930910;0.0930910;0.0581820;0.0698180;0.0814550;0.0930910;0.162909;0.407273;0.849455;1.093818;0.651636;-0.151318;-0.965864;-0.896045;-0.756409;-0.512045;-0.372409;-0.232773;-0.0931360;0.139636;0.151273;0.116364;0.151273;0.186182;0.221091;0.221091;0.232727;0.197818;0.232727;0.244364;0.256;0.267636;0.267636;0.267636;0.302545;0.302545;0.302545;0.314182;0.314182;0.314182;0.325818;0.325818;0.325818;0.337455;0.372364;0.372364;0.337455;0.372364;0.372364;0.337455;0.337455;0.349091;0.314182;0.349091;0.314182;0.279273;0.209455;0.174545;0.174545;0.139636;0.0698180;0.0349090;0.0232730;0.0349090;0.0349090;0;0.0349090;0;0.0349090;0.0465450;0.0581820;0.0698180;0.104727;0.0930910;0.0930910;0.128;0.162909;0.197818;0.209455;0.221091;0.256;0.221091;0.256;0.221091;0.232727;0.267636;0.256;0.256;0.244364;0.279273;0.244364;0.244364;0.279273;0.244364;0.279273;0.244364;0.244364;0.244364;0.256;0.267636;0.302545;0.372364;0.337455;0.407273;0.407273;0.372364;0.302545;0.267636;0.232727;0.244364;0.232727;0.232727;0.244364;0.174545;0.162909;0.197818;0.162909;0.174545;0.162909;0.197818;0.186182;0.186182;0.186182;0.151273;0.186182;0.151273;0.186182;0.430545;0.872727;1.117091;1.047273;0.232727;-0.570227;-0.814591;-0.779682;-0.535318;-0.395682;-0.151318;-0.0116820;0.116364;0.256;0.290909;0.290909;0.302545;0.302545;0.337455;0.325818;0.360727;0.360727;0.360727;0.360727;0.349091;0.384;0.384;0.384;0.418909;0.418909;0.384;0.418909;0.453818;0.418909;0.453818;0.453818;0.442182;0.453818;0.453818;0.465455;0.465455;0.500364;0.465455;0.500364;0.430545;0.418909;0.384;0.418909;0.384;0.349091;0.314182;0.302545;0.267636;0.232727;0.162909;0.0930910;0.128;0.162909;0.162909;0.128;0.139636;0.151273;0.186182;0.186182;0.174545;0.174545;0.209455;0.221091;0.232727;0.267636;0.279273;0.244364;0.256;0.290909;0.279273;0.290909;0.325818;0.314182;0.279273;0.290909;0.290909;0.302545;0.302545;0.314182;0.349091;0.279273;0.279273;0.279273;0.279273;0.290909;0.290909;0.279273;0.279273;0.279273;0.267636;0.256;0.290909;0.290909;0.256;0.221091;0.256;0.267636;0.279273;0.244364;0.279273;0.267636;0.279273;0.279273;0.314182;0.349091;0.360727;0.395636;0.407273;0.372364;0.302545;0.267636;0.232727;0.232727;0.232727;0.232727;0.197818;0.162909;0.174545;0.139636;0.139636;0.128;0.128;0.116364;0.116364;0.151273;0.139636;0.139636;0.128;0.139636;0.384;0.826182;1.070545;1.105455;0.290909;-0.512045;-0.954227;-0.954227;-0.709864;-0.465500;-0.221136;-0.0815;0.0465450;0.116364;0.151273;0.162909;0.174545;0.186182;0.174545;0.186182;0.197818;0.209455;0.221091;0.186182;0.186182;0.221091;0.221091;0.232727;0.232727;0.232727;0.244364;0.244364;0.279273;0.267636;0.267636;0.267636;0.232727;0.244364;0.256;0.244364;0.244364;0.244364;0.244364;0.279273;0.244364;0.209455;0.197818;0.197818;0.162909;0.128;0.0930910;0.0581820;0.0232730;-4.50000e-05;-0.0349550;-0.0698640;-0.104773;-0.104773;-0.139682;-0.128045;-0.116409;-0.0815;-0.151318;-0.0815;-0.0698640;-0.0349550;-0.0349550;-0.0349550;-0.0465910;-0.0116820;0.0116360;-0.0116820;0.0116360;0.0232730;0.0581820;0.0465450;0.0465450;0.0465450;0.0581820;0.0581820;0.0581820;0.0581820;0.0581820;0.0232730;0.0581820;0.0581820;0.0232730;0.0232730;0.0116360;0.0116360;0.0232730;0.0232730;0.0232730;0.0232730;0.0232730;0.0349090;0;-4.50000e-05;-4.50000e-05;-4.50000e-05;-0.0116820;-0.0116820;-0.0116820;-0.0233180;-0.0233180;-0.0349550;-4.50000e-05;-0.0349550;-4.50000e-05;0.0581820;0.0581820;0.0930910;0.128;0.128;0.116364;0.128;0.116364;0.0465450;0.0116360;-0.0116820;-0.0116820;-0.0465910;-0.0582270;-0.0698640;-0.104773;-0.0698640;-0.104773;-0.0931360;-0.0582270;-0.0931360;-0.0931360;-0.0931360;-0.104773;-0.0931360;-0.0582270;0;0.244364;0.686545;0.930909;0.488727;-0.314227;-1.128773;-1.198591;-1.058955;-0.814591;-0.674955;-0.430591;-0.186227;-0.0465910;-0.0582270;-0.0582270;-0.0582270;-0.0233180;-0.0116820;-4.50000e-05;-0.0116820;-0.0233180;0;-0.0233180;0;0.0116360;0.0232730;0.0232730;0.0232730;0.0116360;0.0116360;0.0465450;0.0116360;0.0465450;0.0465450;0.0814550;0.0465450;0.0581820;0.0930910;0.0581820;0.0581820;0.0581820;0.0465450;0.0349090;0.0232730;-4.50000e-05;-0.0116820;-0.0233180;-0.0349550;-0.104773;-0.139682;-0.174591;-0.209500;-0.244409;-0.279318;-0.314227;-0.349136;-0.360773;-0.360773;-0.360773;-0.360773;-0.360773;-0.349136;-0.337500;-0.325864;-0.290955;-0.256045;-0.256045;-0.244409;-0.244409;-0.209500;-0.209500;-0.174591;-0.174591;-0.174591;-0.162955;-0.162955;-0.174591;-0.162955;-0.128045;-0.139682;-0.139682;-0.139682;-0.139682;-0.151318;-0.151318;-0.186227;-0.186227;-0.174591;-0.174591;-0.186227;-0.221136;-0.186227;-0.221136;-0.209500;-0.197864;-0.186227;-0.197864;-0.209500;-0.209500;-0.221136;-0.221136;-0.221136;-0.209500;-0.221136;-0.186227;-0.174591;-0.139682;-0.104773;-0.0931360;-0.0931360;-0.104773;-0.139682;-0.279318;-0.244409;-0.244409;-0.256045;-0.290955;-0.290955;-0.290955;-0.325864;-0.337500;-0.325864;-0.325864;-0.337500;-0.349136;-0.360773;-0.325864;-0.314227;-0.279318;-0.314227;-0.244409;0.186182;0.628364;0.616727;-0.186227;-1.000773;-1.442955;-1.373136;-1.23350;-0.989136;-0.849500;-0.605136;-0.465500;-0.325864;-0.290955;-0.279318;-0.267682;-0.232773;-0.244409;-0.232773;-0.221136;-0.221136;-0.209500;-0.221136;-0.209500;-0.197864;-0.186227;-0.174591;-0.174591;-0.174591;-0.139682;-0.151318;-0.162955;-0.197864;-0.162955;-0.151318;-0.139682;-0.139682;-0.139682;-0.128045;-0.128045;-0.128045;-0.128045;-0.139682;-0.174591;-0.186227;-0.221136;-0.232773;-0.244409;-0.279318;-0.314227;-0.349136;-0.384045;-0.418955;-0.488773;-0.500409;-0.535318;-0.535318;-0.546955;-0.558591;-0.523682;-0.523682;-0.512045;-0.477136;-0.512045;-0.500409;-0.465500;-0.430591;-0.395682;-0.395682;-0.360773;-0.360773;-0.349136;-0.337500;-0.302591;-0.337500;-0.337500;-0.325864;-0.325864;-0.314227;-0.314227;-0.349136;-0.314227;-0.325864;-0.314227;-0.314227;-0.325864;-0.325864;-0.325864;-0.360773;-0.349136;-0.314227;-0.349136;-0.360773;-0.360773;-0.325864;-0.360773;-0.372409;-0.372409;-0.372409;-0.360773;-0.360773;-0.360773;-0.349136;-0.360773;-0.349136;-0.314227;-0.314227;-0.279318;-0.244409;-0.244409;-0.232773;-0.221136;-0.256045;-0.325864;-0.395682;-0.395682;-0.384045;-0.384045;-0.418955;-0.430591;-0.500409;-0.465500;-0.430591;-0.465500;-0.465500;-0.465500;-0.453864;-0.488773;-0.453864;-0.453864;-0.442227;-0.430591;-0.186227;0.244364;0.488727;0.0465450;-0.756409;1.407955;1.396318;-1.442955;-1.198591;-1.058955;-0.814591;-0.674955;-0.430591;-0.430591;-0.418955;-0.407318;-0.395682;-0.395682;-0.384045;-0.349136;-0.360773;-0.372409;-0.337500;-0.349136;-0.337500;-0.349136;-0.337500;-0.349136;-0.349136;-0.314227;-0.314227;-0.314227;-0.302591;-0.290955;-0.325864;-0.290955;-0.302591;-0.302591;-0.302591;-0.314227;-0.314227;-0.314227;-0.325864;-0.360773;-0.325864;-0.360773;-0.360773;-0.372409;-0.407318;-0.442227;-0.512045;-0.546955;-0.558591;-0.593500;-0.628409;-0.663318;-0.674955;-0.686591;-0.686591;-0.698227;-0.663318;-0.628409;-0.616773;-0.581864;-0.581864;-0.570227;-0.570227;-0.535318;-0.535318;-0.500409;-0.512045;-0.523682;-0.512045;-0.512045;-0.500409;-0.488773;-0.453864;-0.442227;-0.477136;-0.465500;-0.453864;-0.453864;-0.488773;-0.488773;-0.453864;-0.465500;-0.477136;-0.477136;-0.442227;-0.453864;-0.488773;-0.488773;-0.523682;-0.453864;-0.442227;-0.453864;-0.488773;-0.477136;-0.477136;-0.488773;-0.500409;-0.465500;-0.430591;-0.465500;-0.430591;-0.395682;-0.395682;-0.360773;-0.325864;-0.314227;-0.349136;-0.314227;-0.325864;-0.395682;-0.430591;-0.430591;-0.430591;-0.465500;-0.465500;-0.500409;-0.512045;-0.477136;-0.512045;-0.512045;-0.523682;-0.488773;-0.488773;-0.488773;-0.453864;-0.453864;-0.488773;-0.418955;0.0116360;0.453818;0.593455;0.151273;-0.651682;-1.466227;1.442864;-1.466227;-1.221864;-1.082227;-0.837864;-0.593500;-0.523682;-0.453864;-0.384045;-0.349136;-0.384045;-0.372409;-0.384045;-0.314227;-0.314227;-0.349136;-0.314227;-0.314227;-0.302591;-0.302591;-0.302591;-0.337500;-0.302591;-0.290955;-0.256045;-0.221136;-0.256045;-0.244409;-0.279318;-0.244409;-0.209500;-0.197864;-0.209500;-0.209500;-0.209500;-0.221136;-0.221136;-0.256045;-0.267682;-0.267682;-0.337500;-0.372409;-0.384045;-0.418955;-0.430591;-0.465500;-0.465500;-0.535318;-0.546955;-0.581864;-0.616773;-0.605136;-0.640045;-0.605136;-0.570227;-0.535318;-0.546955;-0.535318;-0.570227;-0.535318;-0.500409;-0.465500;-0.430591;-0.430591;-0.430591;-0.430591;-0.395682;-0.407318;-0.395682;-0.360773;-0.360773;-0.372409;-0.384045;-0.418955;-0.384045;-0.349136;-0.349136;-0.337500;-0.349136;-0.384045;-0.418955;-0.349136;-0.337500;-0.325864;-0.360773;-0.395682;-0.360773;-0.372409;-0.372409;-0.372409;-0.384045;-0.384045;-0.395682;-0.360773;-0.372409;-0.372409;-0.384045;-0.372409;-0.360773;-0.372409;-0.360773;-0.325864;-0.290955;-0.256045;-0.256045;-0.290955;-0.256045;-0.244409;-0.314227;-0.349136;-0.360773;-0.372409;-0.407318;-0.395682;-0.430591;-0.442227;-0.453864;-0.488773;-0.418955;-0.407318;-0.418955;-0.430591;-0.418955;-0.418955;-0.453864;-0.418955;-0.418955;-0.174591;0.256;0.500364;0.256;-0.546955;-1.36150;1.373045;-1.466227;-1.221864;-0.977500;-0.733136;-0.488773;-0.349136;-0.349136;-0.314227;-0.302591;-0.302591;-0.290955;-0.325864;-0.290955;-0.325864;-0.256045;-0.244409;-0.256045;-0.267682;-0.302591;-0.302591;-0.290955;-0.256045;-0.221136;-0.151318;-0.186227;-0.186227;-0.174591;-0.174591;-0.162955;-0.174591;-0.186227;-0.186227;-0.174591;-0.186227;-0.174591;-0.209500;-0.209500;-0.244409;-0.256045;-0.267682;-0.267682;-0.302591;-0.337500;-0.372409;-0.442227;-0.512045;-0.523682;-0.523682;-0.558591;-0.593500;-0.593500;-0.605136;-0.605136;-0.570227;-0.535318;-0.500409;-0.500409;-0.500409;-0.465500;-0.430591;-0.430591;-0.395682;-0.360773;-0.360773;-0.325864;-0.360773;-0.360773;-0.325864;-0.325864;-0.314227;-0.302591;-0.302591;-0.302591;-0.372409;-0.337500;-0.302591;-0.302591;-0.372409;-0.302591;-0.267682;-0.256045;-0.290955;-0.302591;-0.314227;-0.314227;-0.302591;-0.337500;-0.325864;-0.325864;-0.290955;-0.279318;-0.290955;-0.302591;-0.290955;-0.290955;-0.302591;-0.314227;-0.279318;-0.267682;-0.267682;-0.267682;-0.232773;-0.197864;-0.209500;-0.174591;-0.139682;-0.174591;-0.244409;-0.314227;-0.302591;-0.314227;-0.302591;-0.302591;-0.337500;-0.372409;-0.384045;-0.384045;-0.372409;-0.372409;-0.360773;-0.372409;-0.372409;-0.360773;-0.395682;-0.384045;-0.395682;-0.151318;0.279273;0.721455;-0.0815;-0.896045;-1.338227;-1.477864;-1.338227;-1.093864;-0.849500;-0.709864;-0.465500;-0.325864;-0.314227;-0.279318;-0.290955;-0.256045;-0.244409;-0.232773;-0.221136;-0.256045;-0.244409;-0.232773;-0.197864;-0.162955;-0.174591;-0.174591;-0.174591;-0.174591;-0.186227;-0.151318;-0.186227;-0.151318;-0.116409;-0.116409;-0.151318;-0.116409;-0.151318;-0.116409;-0.116409;-0.116409;-0.116409;-0.116409;-0.128045;-0.128045;-0.162955;-0.162955;-0.197864;-0.232773;-0.244409;-0.256045;-0.290955;-0.325864;-0.395682;-0.430591;-0.430591;-0.442227;-0.477136;-0.442227;-0.477136;-0.477136];
VoicesPerOctave = 16;
useLinearFreq = 1;
noiseWeight = 0.0;
%% Regular CWT filterbank
[cfs, psif, Freq, coneOfInfluence, NyquistBin] = morletCWT(x, VoicesPerOctave, useLinearFreq, noiseWeight);
scalcfs = real(cfs(end, :));
figure(2)
subplot(1,2,1)
plot(psif(:, 1 : NyquistBin)');
axis tight
title('Analysis filterbank shape')
figure(1)
subplot(1,2,1)
% [cfs] = cwt(x, 'amor', 'VoicesPerOctave', VoicesPerOctave);
imagesc(log10(abs(cfs) + eps))
title('CWT of signal x with morlet filterbank')
xrecAN = ICWT_DualFrame(cfs, psif); % Dual frame form
xrecSI = icwt(cfs(1 : end - 1, :),[], ScalingCoefficients = scalcfs); % Single integral form
SNR_FIRAnalysisSynthesis = 10*log10(sum(abs(x).^2)/sum(abs(x-xrecAN').^2));
SNR_SingleIntegral = 10*log10(sum(abs(x).^2)/sum(abs(x-xrecSI').^2));
%% Regular CWT filterbank with noise on top of it
noiseWeight = 0.2;
[cfs, psif, Freq, coneOfInfluence, NyquistBin] = morletCWT(x, VoicesPerOctave, useLinearFreq, noiseWeight);
scalcfs = real(cfs(end, :));
figure(2)
subplot(1,2,2)
plot(psif(:, 1 : NyquistBin)')
axis tight
title('Analysis filterbank(With noise) shape')
figure(1)
subplot(1,2,2)
% [cfs] = cwt(x, 'amor', 'VoicesPerOctave', VoicesPerOctave);
imagesc(log10(abs(cfs) + eps))
title('CWT of signal x with noisy morlet filterbank')
xrecAN = ICWT_DualFrame(cfs, psif); % Dual frame form
xrecSI = icwt(cfs(1 : end - 1, :),[], ScalingCoefficients = scalcfs); % Single integral form
SNR_NoisyFIRAnalysisSynthesis = 10*log10(sum(abs(x).^2)/sum(abs(x-xrecAN').^2));
SNR_NoisySingleIntegral = 10*log10(sum(abs(x).^2)/sum(abs(x-xrecSI').^2));
%% Print SNR
disp('FIR synthesis of clean CWT filterbank = ' + string(SNR_FIRAnalysisSynthesis) + ' dB')
disp('Single integral of clean CWT filterbank = ' + string(SNR_SingleIntegral) + ' dB')
disp('FIR synthesis of noisy CWT filterbank = ' + string(SNR_NoisyFIRAnalysisSynthesis) + ' dB')
disp('Single integral of noisy CWT filterbank = ' + string(SNR_NoisySingleIntegral) + ' dB')
function [cfs, psif, Freq, coneOfInfluence, NyquistBin] = morletCWT(x, VoicesPerOctave, isLinearScale, noiseWeight)
N = length(x);
omega = (1:fix(N/2));
omega = omega.*(2*pi)/N;
omega = [0, omega, -omega(fix((N-1)/2):-1:1)];
cf = 6;
[scales, scalesLinear, minScale] = getCWTScales(N, VoicesPerOctave, cf);
if isLinearScale
    scales = scalesLinear;
end
WaveletCenterFrequencies = (cf / (2 * pi)) ./ scales;
[psif, Freq] = morletAnalytical(omega, scales);
tmpphidft = morletscalingfunction(omega, max(scales));
NyquistBin = getFFTHalfLen(N);
if mod(N, 2) == 0
    % N even
    phidft = [tmpphidft(1:NyquistBin), flip(tmpphidft(2:NyquistBin-1))];
else
    % N odd
    phidft = [tmpphidft(1:NyquistBin), flip(tmpphidft(2:NyquistBin))];
end
psif = cat(1, psif, phidft);
psif(:, 1 : NyquistBin) = psif(:, 1 : NyquistBin) + randn(size(psif(:, 1 : NyquistBin))) * noiseWeight;
xdft = fft(x(:)');
wvConv = xdft .* psif;
cfs = ifft(wvConv, [], 2);
coneOfInfluence = 1 ./ (((2*pi)/cf) / sqrt(2) * createCoiIndices(N));
% Truncate COI values at max
coneOfInfluence(coneOfInfluence>max(WaveletCenterFrequencies)) = max(WaveletCenterFrequencies);
end
function [psidft, F] = morletAnalytical(omega, scales)
somega = scales'*omega;
fc = 6;
mul = 2;
squareterm = (somega-fc).*(somega-fc);
gaussexp = -squareterm./2;
expnt = gaussexp.*(somega > 0);
psidft = mul*exp(expnt).*(somega > 0);
F = fc/(2*pi)./scales;
end
function [scales, scalesLinear, minScale] = getCWTScales(N, nv, cf)
cutoff = 10;
% Number of standard deviations
standardDeviations = 2;
maxScale = N / (sqrt(2) * standardDeviations);
omegac = getFreqFromCutoffAmor(cutoff / 100, cf);
% Minimum scale
minScale = omegac/pi;
% If the max scale (min freq) is beyond the max freq, set it one step away
if maxScale < minScale*2^(1/nv)
    maxScale = minScale*2^(1/nv);
end
numoctaves = max(log2(maxScale/minScale), 1/nv);
a0 = 2^(1/nv);
scales = minScale*a0.^(0:numoctaves*nv);
scalesLinear = minScale * 1./linspace(1, 1 / (a0.^(numoctaves*nv)), fix(numoctaves*nv) + 1);
end
function halfLen = getFFTHalfLen(fftLen)
if mod(fftLen, 2) == 0
    halfLen = (fftLen / 2) + 1;
else
    halfLen = (fftLen + 1) / 2;
end
end
function indices = createCoiIndices(N)
indices = zeros(N,1);
if mod(N, 2) == 0
    % Even length case
    indices(1:N/2) = (1:N/2);
    indices(N/2+1:N) = (N/2:-1:1);
else
    % Odd length case
    M = ceil(N/2);
    indices(1:M) = (1:M);
    indices(M+1:N) = (M-1:-1:1);
end
end
function [phidft,phi] = morletscalingfunction(omega,scale)
fun = @(om)exp(-(om-6).^2)./om;
phidft = zeros(size(omega));
posfreq = scale.*omega(omega>0);
for kk = 1:numel(posfreq)
    phidft(kk) = morletintegral(fun,posfreq(kk));
end
ampdc = phidft(1);
phidft = phidft./ampdc;
phi = ifftshift(ifft(phidft));
end
function val = morletintegral(fun,omega)
val = quadgk(fun,omega,Inf);
end
function omegac = getFreqFromCutoffAmor(cutoff, cf)
alpha = 2*cutoff;
psihat = @(omega)alpha - 2*exp(-(omega-cf).^2/2);
% maximum limit on zero search ensures frequency response goes to 0
omax = ((2*750).^0.5+cf);
if psihat(cf) > 0
    omegac = omax;
else
    omegac = fzero(psihat,[cf omax]);
end
end
function xrec = ICWT_DualFrame(cfs, AnalysisFilters)
gf = sum(AnalysisFilters .* AnalysisFilters, 1);
dw = gf + [gf(:,1) flip(conj(gf(:,2:size(gf,2))),2)];
Fk = 2 * AnalysisFilters ./ dw;
cfsDFT = fft(cfs,[],2);
xdft = cfsDFT.*Fk;
xrec = ifft(xdft,[],2);
xrec = real(sum(xrec));
end